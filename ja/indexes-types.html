<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>インデックスの種類</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version "><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.1.4文書"
HREF="index.html"><LINK
REL="UP"
TITLE="インデックス"
HREF="indexes.html"><LINK
REL="PREVIOUS"
TITLE="序文"
HREF="indexes-intro.html"><LINK
REL="NEXT"
TITLE="複数列インデックス"
HREF="indexes-multicolumn.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=euc-jp"><META
NAME="creation"
CONTENT="2012-06-16T03:12:10"></HEAD
><BODY
CLASS="SECT1"
><script type="text/javascript">
var mod_layout = 'test';
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-50659-6");
pageTracker._trackPageview();
</script>
<style>
body{margin:0;}
#lay_body{margin:8px;}
#lay_header{margin:0 0 4px 0;border:0;padding:0;}
#lay_header .b1{border-bottom:#cef solid 1px;}
#lay_header .b2{border-bottom:#8df solid 1px;}
#lay_header .b3{border-bottom:#4bf solid 1px;padding:5px 5px 3px 5px;background:#0af;text-align:center;color:#fff;}
#lay_header a{text-decoration:none;color:#fff;font-weight:bold;}
#lay_header a:hover{text-decoration:underline;}
</style>
<div id="lay_header"><div class="b1"><div class="b2"><div class="b3">
<a href="http://lets.postgresql.jp/" target="_blank">PostgreSQLポータルサイト ＜Let's Postgres＞ http://lets.postgresql.jp/</a><br>
入門から運用、チューニングノウハウ、新機能の解説など、幅広い内容の技術解説記事をお読みいただけます。
</div></div></div></div>
<div id="lay_body">
<DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="5"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.1.4文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="序文"
HREF="indexes-intro.html"
ACCESSKEY="P"
>&#21069;&#12398;&#12506;&#12540;&#12472;</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="インデックス"
HREF="indexes.html"
>&#24059;&#25147;&#12375;</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>&#31532; 11&#31456;インデックス</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
TITLE="インデックス"
HREF="indexes.html"
>&#26089;&#36865;&#12426;</A
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
TITLE="複数列インデックス"
HREF="indexes-multicolumn.html"
ACCESSKEY="N"
>&#27425;&#12398;&#12506;&#12540;&#12472;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="INDEXES-TYPES"
>11.2. インデックスの種類</A
></H1
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>では、B-tree、Hash、GiST、GINといった複数の種類のインデックスを使用可能です。
インデックスの各種類は、異なる種類の問い合わせに最も適した、異なるアルゴリズムを使用します。
デフォルトで<TT
CLASS="COMMAND"
>CREATE INDEX</TT
>コマンドは、B-treeインデックスを作成し、それはほとんどの一般的状況に適合します。
  </P
><P
>   
   
B-treeインデックスは、ある順番でソート可能なデータに対する等価性や範囲を問い合わせることを扱うことができます。
具体的には、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の問い合わせプランナは、インデックスの付いた列を次の演算子を使用して比較する場合に、B-treeインデックスの使用を検討します。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

また、<TT
CLASS="LITERAL"
>BETWEEN</TT
>や<TT
CLASS="LITERAL"
>IN</TT
>などのこれらの演算子の組み合わせと等価な式をB-treeインデックス検索で実装することができます。
インデックスの付いた列に対する<TT
CLASS="LITERAL"
>IS NULL</TT
>や<TT
CLASS="LITERAL"
>IS NOT NULL</TT
>でもB-treeインデックスを使用することができます。
  </P
><P
>オプティマイザは、パターンマッチ演算子<TT
CLASS="LITERAL"
>LIKE</TT
>、<TT
CLASS="LITERAL"
>~</TT
>を含む問い合わせでも、そのパターンが定数であり、先頭文字列を指定している<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>場合</I
></SPAN
>B-treeインデックスを使用することができます。
例えば、<TT
CLASS="LITERAL"
>col LIKE 'foo%'</TT
>または<TT
CLASS="LITERAL"
>col ~ '^foo'</TT
>です。
<TT
CLASS="LITERAL"
>col LIKE '%bar'</TT
>では使用されません。
しかし、データベースがCロケールを使用していない場合、パターンマッチ問い合わせのインデックス付けをサポートする特別な演算子クラスでインデックスを作成しなければなりません。
後述の<A
HREF="indexes-opclass.html"
>&#38917;11.9</A
>を参照してください。
なお、<TT
CLASS="LITERAL"
>ILIKE</TT
>と<TT
CLASS="LITERAL"
>~*</TT
>でもB-treeインデックスを使用することができますが、パターンが英字以外の文字、つまり、大文字小文字の違いの影響がない文字で始まる場合のみです。
  </P
><P
>B-treeインデックスをソートされた順序でデータを受けとるために使用することもできます。
これは常に単純なスキャンとソート処理より高速になるものではありませんが、よく役に立つことがあります。
  </P
><P
>   
   
ハッシュインデックスは単純な等価性比較のみを扱うことができます。
問い合わせプランナでは、インデックスの付いた列を<TT
CLASS="LITERAL"
>=</TT
>演算子を使用して比較する場合に、ハッシュインデックスの使用を検討します。
ハッシュインデックスを作成するには、以下のようなコマンドを使用してください。
</P><PRE
CLASS="SYNOPSIS"
>CREATE INDEX <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> ON <TT
CLASS="REPLACEABLE"
><I
>table</I
></TT
> USING hash (<TT
CLASS="REPLACEABLE"
><I
>column</I
></TT
>);</PRE
><P>
  </P
><DIV
CLASS="CAUTION"
><P
></P
><TABLE
CLASS="CAUTION"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>&#27880;&#24847;</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>現在ハッシュインデックス操作はWALに記録されません。
そのため、データベースクラッシュの後ハッシュインデックスを<TT
CLASS="COMMAND"
>REINDEX</TT
>で再構築しなければならない可能性があります。
また、ストリーミングレプリケーションやファイルベースのレプリケーションでは複製されません。
この理由により、ハッシュインデックスの使用は現在お勧めできません。
   </P
></TD
></TR
></TABLE
></DIV
><P
>   
   
GiSTインデックスは単一種類のインデックスではなく、多くの異なるインデックス戦略を実装することができる基盤です。
したがって、具体的なGiSTインデックスで使用できる演算子はインデックス戦略（<I
CLASS="FIRSTTERM"
>演算子クラス</I
>）によって異なります。
例えば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の標準配布物には、複数の二次元幾何データ型用のGiST演算子クラスが含まれています。
これらの演算子を使用してインデックス付けされた問い合わせをサポートします。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&lt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&gt;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;&lt;|</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&lt;|</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>|&amp;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>|&gt;&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>@&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;@</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>~=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&amp;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

（これらの演算子の意味については<A
HREF="functions-geometry.html"
>&#38917;9.11</A
>を参照してください。）
他の多くのGiST演算子クラスが<TT
CLASS="LITERAL"
>contrib</TT
>群や別のプロジェクトとして利用可能です。
詳細は<A
HREF="gist.html"
>&#31532;53&#31456;</A
>を参照してください。
  </P
><P
>GiSTインデックスは以下のような<SPAN
CLASS="QUOTE"
>"最近傍"</SPAN
>検索を最適化する機能も持ちます。
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT * FROM places ORDER BY location &#60;-&#62; point '(101,456)' LIMIT 10;</PRE
><P>
これは指定された対象地点に最も近い１０箇所を見つけ出します。
繰り返しますが、これができるかどうかは使用される特定の演算子クラスに依存します。
  </P
><P
>   
   
GINは転置インデックスであり、例えば配列など複数のキーを持つ値を扱うことができます。
GiST同様、GINも多くの異なるユーザ定義のインデックス戦略を持つことができ、GINが使用できる具体的な演算子はインデックス戦略によって変化します。
例えば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>標準配布物には、1次元配列用のGIN演算子クラスが含まれています。
これは、以下の演算子を使用する問い合わせに対するインデックスをサポートします。

   <P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>&lt;@</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>@&gt;</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>=</TT
></TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>&amp;&amp;</TT
></TD
></TR
></TBODY
></TABLE
><P
></P
>

（これらの演算子の意味については<A
HREF="functions-array.html"
>&#38917;9.17</A
>を参照してください。）
他の多くのGIN演算子クラスは<TT
CLASS="LITERAL"
>contrib</TT
>群または別のプロジェクトで利用可能です。
詳細は<A
HREF="gin.html"
>&#31532;54&#31456;</A
>を参照してください。
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="indexes-intro.html"
ACCESSKEY="P"
>&#21069;&#12398;&#12506;&#12540;&#12472;</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>&#12507;&#12540;&#12512;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="indexes-multicolumn.html"
ACCESSKEY="N"
>&#27425;&#12398;&#12506;&#12540;&#12472;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>序文</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="indexes.html"
ACCESSKEY="U"
>&#19978;&#12395;&#25147;&#12427;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>複数列インデックス</TD
></TR
></TABLE
></DIV
></BODY
></HTML
></div>
