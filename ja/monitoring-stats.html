<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>統計情報コレクタ</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version "><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 9.1.4文書"
HREF="index.html"><LINK
REL="UP"
TITLE="データベース活動状況の監視"
HREF="monitoring.html"><LINK
REL="PREVIOUS"
TITLE="標準的なUnixツール"
HREF="monitoring-ps.html"><LINK
REL="NEXT"
TITLE="ロックの表示"
HREF="monitoring-locks.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=euc-jp"><META
NAME="creation"
CONTENT="2012-06-16T03:12:10"></HEAD
><BODY
CLASS="SECT1"
><script type="text/javascript">
var mod_layout = 'test';
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-50659-6");
pageTracker._trackPageview();
</script>
<style>
body{margin:0;}
#lay_body{margin:8px;}
#lay_header{margin:0 0 4px 0;border:0;padding:0;}
#lay_header .b1{border-bottom:#cef solid 1px;}
#lay_header .b2{border-bottom:#8df solid 1px;}
#lay_header .b3{border-bottom:#4bf solid 1px;padding:5px 5px 3px 5px;background:#0af;text-align:center;color:#fff;}
#lay_header a{text-decoration:none;color:#fff;font-weight:bold;}
#lay_header a:hover{text-decoration:underline;}
</style>
<div id="lay_header"><div class="b1"><div class="b2"><div class="b3">
<a href="http://lets.postgresql.jp/" target="_blank">PostgreSQLポータルサイト ＜Let's Postgres＞ http://lets.postgresql.jp/</a><br>
入門から運用、チューニングノウハウ、新機能の解説など、幅広い内容の技術解説記事をお読みいただけます。
</div></div></div></div>
<div id="lay_body">
<DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="5"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>PostgreSQL 9.1.4文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="標準的なUnixツール"
HREF="monitoring-ps.html"
ACCESSKEY="P"
>&#21069;&#12398;&#12506;&#12540;&#12472;</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="データベース活動状況の監視"
HREF="monitoring.html"
>&#24059;&#25147;&#12375;</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>&#31532; 27&#31456;データベース活動状況の監視</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
TITLE="データベース活動状況の監視"
HREF="monitoring.html"
>&#26089;&#36865;&#12426;</A
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
TITLE="ロックの表示"
HREF="monitoring-locks.html"
ACCESSKEY="N"
>&#27425;&#12398;&#12506;&#12540;&#12472;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="MONITORING-STATS"
>27.2. 統計情報コレクタ</A
></H1
><P
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>の<I
CLASS="FIRSTTERM"
>統計情報コレクタ</I
>はサーバの活動状況に関する情報を収集し、報告するサブシステムです。
現在、コレクタはテーブルとインデックスへのアクセスをディスクブロックおよび個々の行単位で数えることができます。
またこれは、各テーブル内の総行数、および、各テーブルでのVACUUMやANALYZEの実施情報を追跡します。
また、ユーザ定義関数の呼ばれた回数、それぞれの消費した総時間をカウントします。
  </P
><P
>また、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>は他のサーバプロセスによって現在実行されている問い合わせを正確に報告する機能を持ちます。
これはコレクタプロセスから独立している機能です。
  </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="MONITORING-STATS-SETUP"
>27.2.1. 統計情報収集のための設定</A
></H2
><P
>統計情報の収集によって問い合わせの実行に少しオーバーヘッドが加わりますので、システムは情報を収集するようにもしないようにも設定することができます。
これは通常は<TT
CLASS="FILENAME"
>postgresql.conf</TT
>内で設定される、設定パラメータによって制御されます
（設定パラメータの設定についての詳細は<A
HREF="runtime-config.html"
>&#31532;18&#31456;</A
>を参照してください）。
  </P
><P
><A
HREF="runtime-config-statistics.html#GUC-TRACK-COUNTS"
>track_counts</A
>パラメータは、テーブルおよびインデックスアクセスに関する統計情報を収集するかどうか制御します。
  </P
><P
><A
HREF="runtime-config-statistics.html#GUC-TRACK-FUNCTIONS"
>track_functions</A
>パラメータは、ユーザ定義関数の使用状況を追跡するかどうかを指定できます。
  </P
><P
><A
HREF="runtime-config-statistics.html#GUC-TRACK-ACTIVITIES"
>track_activities</A
>パラメータにより、すべてのサーバプロセスで現在実行されているコマンドを監視することができます。
  </P
><P
>通常、これらの変数は全てのサーバプロセスに適用できるように<TT
CLASS="FILENAME"
>postgresql.conf</TT
>内で設定されます。 
しかし、<A
HREF="sql-set.html"
>SET</A
>コマンドを使用して、個別のセッションで有効または無効にすることができます
（一般ユーザがその活動を管理者に隠すことを防止するために、スーパーユーザのみが<TT
CLASS="COMMAND"
>SET</TT
>を使用してこれらのパラメータを変更することができます。）
  </P
><P
>統計情報コレクタはバックエンドと必要な情報(自動バキュームに関するものも含む)を収集し、一時ファイルへ送信します。。これらのファイルは<TT
CLASS="FILENAME"
>pg_stat_tmp</TT
>サブディレクトリに格納されます。
postmasterがシャットダウンした際は、統計情報データの永続的なコピーが<TT
CLASS="FILENAME"
>global</TT
>サブディレクトリに格納されます。性能向上のため、<A
HREF="runtime-config-statistics.html#GUC-STATS-TEMP-DIRECTORY"
>stats_temp_directory</A
>パラメータでRAMベースのファイルシステムを指定することで、物理I/Oの要求を減らすことができます。
  </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="MONITORING-STATS-VIEWS"
>27.2.2. 収集した統計情報の表示</A
></H2
><P
>統計情報の収集結果を表示するための、多くの定義済みのビューがあり、<A
HREF="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE"
>&#34920;27-1</A
>に一覧表示されています。
他にも、基礎的な統計情報関数を使用した独自のビューを構築することもできます。
  </P
><P
>この統計情報を使用して、現在の活動状況を監視する場合、この情報は即座に更新されないことを認識することが重要です。
個別のサーバプロセスは、待機状態になる直前に、新しい統計情報に関する数をコレクタに送信します。 
ですので、実行中の問い合わせやトランザクションは表示上の総和には影響を与えません。  
また、コレクタ自体もおよそ<TT
CLASS="VARNAME"
>PGSTAT_STAT_INTERVAL</TT
>（サーバ構築時に変更しない限り500）ミリ秒に一度新しい報告を出力します。
ですので、表示上の情報は実際の活動から遅れて表示されます。
しかし、<TT
CLASS="VARNAME"
>track_activities</TT
>で収集される現在の問い合わせの情報は常に最新です。
  </P
><P
>この他の重要なポイントは、いつサーバプロセスが統計情報を表示するように尋ねられるかです。 
サーバプロセスは、まずコレクタによって発行された最も最近の報告を取り出します。
そして、現在のトランザクションが終わるまで、全ての統計情報ビューと関数においてこのスナップショットを使用し続けます。
ですから、現在のトランザクションを続けている間、統計情報は一定の情報を示します。
同様に、全セッションの現在の問い合わせに関する情報も、そうした情報がトランザクションで最初に要求された時に収集され、そのトランザクションの間同じ情報が表示されます。
これはバグではなく、特徴です。 
なぜなら、これにより、知らない間に値が変更することを考慮することなく、統計情報に対して複数の問い合わせを実行し、その結果を相関することができるからです。
しかし、各問い合わせで新しい結果を取り出したい場合は、確実にトランザクションブロックの外側でその問い合わせを行ってください。
他にも<CODE
CLASS="FUNCTION"
>pg_stat_clear_snapshot</CODE
>()を呼び出すこともできます。
これは現在のトランザクションの統計情報スナップショットを（もしあれば）破棄します。
次に統計情報を使用する場合に新しいスナップショットを取り出すことになります。
  </P
><P
>  
   トランザクションからは、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_all_tables</TT
>、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_sys_tables</TT
>、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_user_tables</TT
>、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_user_functions</TT
>、およびこれらのビューの元となっている関数を通じて、自身の統計情報(まだコレクタに送られていない)も参照することができます。
   これらの数値はトランザクション中に継続的に更新されていくため上記の様な(静的な情報を示す)振る舞いとはなりません。
  </P
><DIV
CLASS="TABLE"
><A
NAME="MONITORING-STATS-VIEWS-TABLE"
></A
><P
><B
>&#34920; 27-1. 標準統計情報ビュー</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
>ビュー名</TH
><TH
>説明</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_activity</TT
></TD
><TD
>サーバプロセス当たり1行の形で、データベースのOID、データベース名、プロセス<ACRONYM
CLASS="ACRONYM"
>ID</ACRONYM
>、ユーザのOID、ユーザ名、アプリケーション名、クライアントアドレス、ホスト名(可能であれば)、クライアントアドレスとポート番号、サーバプロセスの開始時刻、現在のトランザクションの開始時刻、現在の問い合わせの実行開始時刻、プロセスの待機状態、そして現在の問い合わせのテキストを表示します。
現在の問い合わせについてのデータを報告する列は<TT
CLASS="VARNAME"
>track_activities</TT
>パラメータが有効な場合に表示されます。
さらに、その列は、ビューを確認するユーザがスーパーユーザ、あるいは報告対象プロセスを所有するユーザと同じである場合にのみ参照可能です。
クライアントのホスト名は、<A
HREF="runtime-config-logging.html#GUC-LOG-HOSTNAME"
>log_hostname</A
>が設定されているか、<TT
CLASS="FILENAME"
>pg_hba.conf</TT
>による処理中にユーザのホスト名を探索する必要がある場合のみ有効となります。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_bgwriter</TT
></TD
><TD
>バックグランドライタによるクラスタ全体の統計情報、つまり、予定されるチェックポイント数、要求されるチェックポイント数、チェックポイントおよび整理用スキャンで書き込みされるバッファ数、およびあまりに多くのバッファを書き出したために整理用スキャンを中断したバックグランドライタの個数を、1行のみ表示します。
また、バックエンド（つまりバックグランドライタによるものではない）により書き込まれたバッファ、バックエンドが自身でfsyncを呼んだ(通常、バックエンド自身が書き込み場合でもバックグラウンドライタがそれらを制御します)回数、割り当てられた総バッファ量、そして最後に統計情報がリセットされた時間といった共有バッファプールに関する統計情報を含みます。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_database</TT
></TD
><TD
>データベース当たり1行の形で、データベースのOID、データベース名、そのデータベースに接続する活動中のサーバプロセス数、そのデータベース中でコミットされたトランザクションの総数、ロールバックされたトランザクションの総数、読み取られたディスクブロックの総数、バッファヒット（つまり、バッファキャッシュに対象とするブロックが存在するために防止されたブロック読み取り要求）の総数、抽出・挿入・更新・削除により返された行数、(スタンバイサーバ上の)リカバリ処理と競合した結果キャンセルされた総問い合わせ数、そして最後に統計情報をリセットした時間を表示します。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_database_conflicts</TT
></TD
><TD
>データベースあたり1行の形で、データベースのOID、データベース名、このデータベースに対するテーブルスペースの削除/ロックのタイムアウト/古いスナップショット/バッファへのピン保持/デッドロックが原因でキャンセルされた問い合わせ数を表示します。衝突はマスタサーバでは起こらないので、これらの情報はスタンバイサーバでのみ保持しています。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_replication</TT
></TD
><TD
>      WAL送信プロセス当たり1行の形で、プロセス<ACRONYM
CLASS="ACRONYM"
>ID</ACRONYM
>、ユーザOID、ユーザ名、アプリケーション名、クライアントアドレス、ホスト名(可能であれば)、ポート番号、サーバプロセスが処理を開始した時間、そして現在のWAL送信状態と送信したトランザクションログ位置の情報を表示します。加えて、スタンバイサーバは最後に受信して書き込んだトランザクションログの位置、最後にディスクに書き込んだトランザクションログの位置、そして最後に再生したトランザクションログの位置を報告し、このビューに表示します。
      もしスタンバイサーバのアプリケーション名が<TT
CLASS="VARNAME"
>synchronous_standby_names</TT
>に設定したものの一つと一致した場合、sync_priorityも表示されます。これは同期スタンバイが複数ある場合に、それぞれが同期スタンバイとなる優先順位です。
      スーパーユーザのみ、各接続が正確になにを行っているのかを見ることができます。
      クライアントのホスト名は、<A
HREF="runtime-config-logging.html#GUC-LOG-HOSTNAME"
>log_hostname</A
>が設定されているか、<TT
CLASS="FILENAME"
>pg_hba.conf</TT
>による処理中にユーザのホスト名を探索する必要がある場合のみ有効となります。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
></TD
><TD
>現在のデータベース内の各テーブル（TOASTテーブルを含みます）に関する、テーブルのOID、スキーマおよびテーブル名、開始されたシーケンシャルスキャン数、シーケンシャルスキャンで取り出された実際の行数、（そのテーブルに属するすべてのインデックスに対して）開始されたインデックススキャン数、インデックススキャンで取り出された実際の行数、挿入、更新、削除された行数、HOT（つまり分離したインデックス更新がない）だった更新行の数、有効行数、無効行数、手動でそのテーブルが<TT
CLASS="OPTION"
>FULL</TT
>無しでバキュームされた最後の時刻、自動バキュームデーモンによりバキュームされた最後の時刻、手動でアナライズされた前回の時刻、自動バキュームデーモンによりアナライズされた前回の時刻、手動でそのテーブルが<TT
CLASS="OPTION"
>FULL</TT
>無しでバキュームされた回数、自動バキュームデーモンによりバキュームされた回数、手動でアナライズされた回数、自動バキュームデーモンによりアナライズされた回数です。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_sys_tables</TT
></TD
><TD
>システムテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_user_tables</TT
></TD
><TD
>ユーザテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_xact_all_tables</TT
></TD
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
>と似ていますが、現在のトランザクションにて実施された処理結果をカウントします。(数値が見える時点では、これらの数値は<TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
>と関連するビューに含まれて<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>いません</I
></SPAN
>。)
このビューでは、有効行数、無効行数、およびバキュームやアナライズの活動は表示しません。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_xact_sys_tables</TT
></TD
><TD
>      システムテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_all_tables</TT
>と同じです。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_xact_user_tables</TT
></TD
><TD
>      ユーザテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_xact_all_tables</TT
>と同じです。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_all_indexes</TT
></TD
><TD
>現在のデータベース内の各インデックスに関する、テーブルとインデックスのOID、スキーマ、テーブルとインデックスの名前、開始されたインデックススキャン数、インデックススキャンによって読み取られたインデックス項目数、インデックスを使用した単純なインデックススキャンで取り出された実際のテーブル行の数。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_sys_indexes</TT
></TD
><TD
>システムテーブルのインデックスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_all_indexes</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_user_indexes</TT
></TD
><TD
>ユーザテーブルのインデックスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_stat_all_indexes</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_all_tables</TT
></TD
><TD
>現在のデータベース内の各テーブル（TOASTテーブルを含みます）に関する、テーブルのOID、スキーマとテーブル名、そのテーブルから読み取られたディスクブロックの総数、バッファヒット数、そのテーブルに関する全てのインデックスから読み取られたディスクブロック数とバッファヒット数、（存在する場合）そのテーブルの補助的なTOASTテーブルから読み取られたディスクブロック数とバッファヒット数、TOASTテーブルのインデックスから読み取られたディスクブロック数とバッファヒット数。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_sys_tables</TT
></TD
><TD
>システムテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_tables</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_user_tables</TT
></TD
><TD
>ユーザテーブルのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_tables</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_all_indexes</TT
></TD
><TD
>現在のデータベース内の各インデックスに関する、テーブルとインデックスのOID、スキーマ、テーブルおよびインデックスの名前、そのインデックスから読み取られたディスクブロック数とバッファヒット数。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_sys_indexes</TT
></TD
><TD
>システムテーブルのインデックスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_indexes</TT
> と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_user_indexes</TT
></TD
><TD
>ユーザテーブルのインデックスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_indexes</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_all_sequences</TT
></TD
><TD
>現在のデータベース内の各シーケンスオブジェクトに関する、シーケンスのOID、スキーマとシーケンスの名前、そのシーケンスから読み取られたディスクブロック数とバッファヒット数。
      </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_sys_sequences</TT
></TD
><TD
>システムシーケンスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_sequences</TT
>と同じです
（現時点では、システムシーケンスは定義されていませんので、このビューは常に空です）。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_statio_user_sequences</TT
></TD
><TD
>ユーザシーケンスのみが表示される点を除き、<TT
CLASS="STRUCTNAME"
>pg_statio_all_sequences</TT
>と同じです。</TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_user_functions</TT
></TD
><TD
>追跡された全ての関数に関する、関数のOID、スキーマ、関数名、呼ばれた回数、総処理時間、関数自身のみの処理時間。
関数自身の処理時間とは、関数自身が消費した総時間であり、総処理時間とは関数内で呼ばれている別の関数の消費時もを含めたものです。
時間の単位はミリ秒です。
     </TD
></TR
><TR
><TD
><TT
CLASS="STRUCTNAME"
>pg_stat_xact_user_functions</TT
></TD
><TD
>      <TT
CLASS="STRUCTNAME"
>pg_stat_user_functions</TT
>と似ていますが、現在のトランザクション中に呼び出されたものだけをカウントします。
      (数値が見える時点では、これらの数値は<TT
CLASS="STRUCTNAME"
>pg_stat_user_functions</TT
>に含まれて<SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>いません</I
></SPAN
>。)
      </TD
></TR
></TBODY
></TABLE
></DIV
><P
>インデックス単位の統計情報は、どのインデックスが使用され、どの程度効果があるのかを評価する際に、特に有用です。
  </P
><P
>インデックスは直接的、または<SPAN
CLASS="QUOTE"
>"ビットマップスキャン"</SPAN
>経由で使用することができます。
ビットマップスキャンでは、複数のインデックスの出力をANDまたはOR規則を使って組み合わせることができます。
そのため、ビットマップスキャンが使用されると、個々のヒープ行の取り出しと特定のインデックスとを関連付けることは困難です。
したがって、ビットマップスキャンは使用したインデックスに関する<TT
CLASS="STRUCTNAME"
>pg_stat_all_indexes</TT
>.<TT
CLASS="STRUCTFIELD"
>idx_tup_read</TT
>の数を増やします。
さらに、そのテーブルに関する<TT
CLASS="STRUCTNAME"
>pg_stat_all_tables</TT
>.<TT
CLASS="STRUCTFIELD"
>idx_tup_fetch</TT
>の数も増やします。
しかし、<TT
CLASS="STRUCTNAME"
>pg_stat_all_indexes</TT
>.<TT
CLASS="STRUCTFIELD"
>idx_tup_fetch</TT
>を変更しません。
  </P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>&#27880;&#24847;: </B
><SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 8.1より前では、<TT
CLASS="STRUCTFIELD"
>idx_tup_read</TT
> の値と<TT
CLASS="STRUCTFIELD"
>idx_tup_fetch</TT
>の値は基本的には常に同じでした。
<TT
CLASS="STRUCTFIELD"
>idx_tup_read</TT
>はインデックスから取り出したインデックス項目数を数え、一方で<TT
CLASS="STRUCTFIELD"
>idx_tup_fetch</TT
>はテーブルから取り出した有効な行数を数えますので、ビットマップスキャンを考慮しなくても、この2つの値が異なることがあり得るようになりました。
インデックスを使用して取り出した行に無効または未コミットの行があると、後者は少なくなります。
   </P
></BLOCKQUOTE
></DIV
><P
><TT
CLASS="STRUCTNAME"
>pg_statio_</TT
>ビューは主に、バッファキャッシュの効率を評価する際に有用です。
実ディスク読み取りの数がバッファヒットの数よりもかなり少ないのであれば、そのキャッシュはカーネル呼び出しを行うことなく、ほとんどの読み取り要求を満足させています。
しかし、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>バッファキャッシュに存在しないデータはカーネルのI/Oキャッシュにある可能性があり、そのため、物理的な読み取りを行うことなく取り出される可能性があるという<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>のディスクI/Oの取り扱いのため、これらの統計情報は、完全な論拠を提供しません。
<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>のI/O動作に関するより詳細な情報を入手したいのであれば、<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>統計情報コレクタとカーネルのI/Oの取り扱いの監視を行うオペレーティングシステムユーティリティを組み合わせることを勧めます。
  </P
><P
>統計情報を参照する他の方法は、上述の標準ビュー同様に、基礎的な統計情報アクセス関数を使用した問い合わせを作成することで設定することができます。
これらの関数は<A
HREF="monitoring-stats.html#MONITORING-STATS-FUNCS-TABLE"
>&#34920;27-2</A
>にリストされています。データベースごとのアクセス関数は、どのデータベースに対して報告するのかを識別するためにデータベースのOIDを受け付けます。
テーブルごと、インデックスごとの関数はテーブルの、もしくはインデックスのOIDを受け付けます。
関数呼び出しに関する統計情報の関数は、関数のOIDを受け付けます。（この関数を使用して参照できるテーブルとインデックス、及び関数は現在のデータベース内のものだけであることに注意してください）。
サーバプロセスごとのアクセス関数はサーバプロセスID番号を受け付けます。 取り得る範囲は1から現時点で活動中のサーバプロセスの数までです。
  </P
><DIV
CLASS="TABLE"
><A
NAME="MONITORING-STATS-FUNCS-TABLE"
></A
><P
><B
>&#34920; 27-2. 統計情報アクセス関数</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><COL><THEAD
><TR
><TH
>関数</TH
><TH
>戻り値の型</TH
><TH
>説明</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_numbackends</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>integer</TT
></TD
><TD
>データベース内で活動中のサーバ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_xact_commit</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベース内でコミットされたトランザクション数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_xact_rollback</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベース内でロールバックされたトランザクション数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_blocks_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、ディスクブロック抽出要求数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_blocks_hit</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、ディスクブロック要求の内キャッシュに存在した数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_tuples_returned</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、返されるタプル数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_tuples_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、抽出されるタプル数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_tuples_inserted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、挿入されるタプル数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_tuples_updated</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、更新されるタプル数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_tuples_deleted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>データベースに関する、削除されるタプル数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_conflict_tablespace</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       データベースに関するテーブルスペースの削除とリカバリ処理が衝突した結果キャンセルされた問い合わせ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_conflict_lock</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       データベースに関するロックとリカバリ処理が衝突した結果キャンセルされた問い合わせ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_conflict_snapshot</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       データベースに関する古いスナップショットとリカバリ処理が衝突した結果キャンセルされた問い合わせ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_conflict_bufferpin</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       データベースに関するピン留めされたバッファとリカバリ処理が衝突した結果キャンセルされた問い合わせ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_conflict_startup_deadlock</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       データベースに関するデッドロックとリカバリ処理が衝突した結果キャンセルされた問い合わせ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_db_stat_reset_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>      
       データベースの統計情報がリセットされた最終時間。各データベースへの最初の接続時のシステム時間に初期化されます。このリセット時間は<CODE
CLASS="FUNCTION"
>pg_stat_reset</CODE
>をデータベース上で呼び出す際だけでなく、テーブルやインデックスに対して実施される<CODE
CLASS="FUNCTION"
>pg_stat_reset_single_table_counters</CODE
>の実行時にも更新されます。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_numscans</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>引数がテーブルの場合、シーケンシャルスキャンの実行回数。
引数がインデックスの場合インデックススキャンの実行回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_returned</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>引数がテーブルの場合、シーケンシャルスキャンによって読み取られた行数。
引数がインデックスの場合、返されたインデックス項目数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>引数がテーブルの場合、ビットマップスキャンで抽出されたテーブル行の数。 
引数がインデックスの場合、このインデックスを使用した単純なインデックススキャンで抽出された、テーブル行の数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_inserted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルに挿入された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_updated</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルで更新された行数（HOT更新を含む）。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_deleted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルで削除された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_tuples_hot_updated</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルでHOT更新された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_live_tuples</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブル内の有効行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_dead_tuples</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブル内の無効行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_blocks_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルまたはインデックスに関する、ディスクブロック抽出要求数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_blocks_hit</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>テーブルまたはインデックスに関する、ディスクブロック抽出要求の内キャッシュ内に存在した数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_last_vacuum_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>テーブルに対してユーザが行った<TT
CLASS="OPTION"
>FULL</TT
>無しバキュームの最終時刻。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_last_autovacuum_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>テーブルに対して自動バキュームデーモンが行ったバキュームの最終時刻。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_last_analyze_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>テーブルに対してユーザが行ったアナライズの最終時刻。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_last_autoanalyze_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>テーブルに対して自動バキュームデーモンが行ったアナライズの最終時刻。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_vacuum_count</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       テーブルに対してユーザが行った<TT
CLASS="OPTION"
>FULL</TT
>無しバキュームの回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_autovacuum_count</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       テーブルに対して自動バキュームデーモンが行ったバキュームの回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_analyze_count</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       テーブルに対してユーザが行ったアナライズの回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_autoanalyze_count</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       テーブルに対して自動バキュームデーモンが行ったアナライズの回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_numscans</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       引数がテーブルの場合、現在のトランザクションにおけるシーケンシャルスキャンの実行回数。
       引数がインデックスの場合、現在のトランザクションにおけるインデックススキャンの実行回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_returned</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       引数がテーブルの場合、現在のトランザクションにおけるシーケンシャルスキャンによって読み取られた行数。
       引数がインデックスの場合、現在のトランザクションにおいて返されたインデックス項目数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       引数がテーブルの場合、現在のトランザクションにおけるビットマップスキャンで抽出されたテーブル行の数。 
       引数がインデックスの場合、現在のトランザクションにおけるこのインデックスを使用した単純なインデックススキャンで抽出された、テーブル行の数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_inserted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルに挿入された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_updated</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルで更新された行数（HOT更新を含む）。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_deleted</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルで削除された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_tuples_hot_updated</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルでHOT更新された行数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_blocks_fetched</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルまたはインデックスに関する、ディスクブロック抽出要求数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_blocks_hit</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるテーブルまたはインデックスに関する、ディスクブロック抽出要求の内キャッシュ内に存在した数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_backend_pid()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>integer</TT
></TD
><TD
>現在のセッションに接続するサーバプロセスのプロセスID。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_activity</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>setof record</TT
></TD
><TD
>PIDが指定された場合、それに該当するバックエンドの情報のレコード、<TT
CLASS="SYMBOL"
>NULL</TT
>が指定された場合はシステム上のアクティブな各バックエンドの情報がレコードが返されます。返される情報内容は<TT
CLASS="STRUCTNAME"
>pg_stat_activity</TT
>の一部と同じです。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_function_calls</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>関数が呼ばれた回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_function_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>関数内で消費された時間(マイクロ秒)。この関数で呼ばれた別の関数の消費時間も含まれています。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_function_self_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>この関数のみで消費された時間。この関数から呼ばれた別の関数の消費時間は含まれていません。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_function_calls</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおける関数が呼ばれた回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_function_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおける関数内で消費された時間(マイクロ秒)。この関数で呼ばれた別の関数の消費時間も含まれています。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_xact_function_self_time</CODE
>(<TT
CLASS="TYPE"
>oid</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>      
       現在のトランザクションにおけるこの関数のみで消費された時間。この関数から呼ばれた別の関数の消費時間は含まれていません。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_idset()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>setof integer</TT
></TD
><TD
>現在活動中のサーバプロセス数のセット（1から活動中のサーバプロセス数までの間）。
以下の使用例を参照してください。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_pid</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>integer</TT
></TD
><TD
>指定されたサーバプロセスのプロセスID。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_dbid</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>oid</TT
></TD
><TD
>指定されたサーバプロセスのデータベースID。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_userid</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>oid</TT
></TD
><TD
>指定されたサーバプロセスのユーザID。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_activity</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>text</TT
></TD
><TD
>指定されたサーバプロセスの現在の問い合わせ。
ただし、現在のユーザがスーパーユーザの場合、または問い合わせ先セッションのユーザの同一の場合（かつ、<TT
CLASS="VARNAME"
>track_activities</TT
>が有効の場合）のみです。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_waiting</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>boolean</TT
></TD
><TD
>指定されたサーバプロセスがロック待ち状態の場合に真です。
しかし、現在のユーザがスーパーユーザの場合、または、問い合わせを行ったユーザと同一の場合（かつ、<TT
CLASS="VARNAME"
>track_activities</TT
>が有効の場合）に限ります。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_activity_start</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamp with time zone</TT
></TD
><TD
>指定されたサーバプロセスが実行中の問い合わせを開始した時刻。
ただし、現在のユーザがスーパーユーザの場合、または問い合わせ先セッションのユーザの同一の場合（かつ、<TT
CLASS="VARNAME"
>track_activities</TT
>が有効の場合）のみです。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_xact_start</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamp with time zone</TT
></TD
><TD
>指定したサーバプロセスで現在実行中のトランザクションが始まった時刻。
ただし、現在のユーザがスーパーユーザの場合、または問い合わせ先セッションのユーザの同一の場合（かつ、<TT
CLASS="VARNAME"
>track_activities</TT
>が有効の場合）のみです。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_start</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamp with time zone</TT
></TD
><TD
>指定されたサーバプロセスが開始した時刻。
現在のユーザがスーパーユーザまたは問い合わせを行っているセッションユーザと同じでない場合はNULL。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_client_addr</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>inet</TT
></TD
><TD
>指定されたサーバプロセスに接続するクライアントのIPアドレス。
Unixドメインソケット経由の接続の場合はNULL。
また、現在のユーザがスーパーユーザまたは問い合わせを行っているセッションユーザと同じでない場合もNULL。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_backend_client_port</CODE
>(<TT
CLASS="TYPE"
>integer</TT
>)</TT
></TD
><TD
><TT
CLASS="TYPE"
>integer</TT
></TD
><TD
>指定されたサーバプロセスに接続するクライアントのTCPポート番号。
Unixドメインソケット経由の接続の場合は-1。
現在のユーザがスーパーユーザまたは問い合わせを行っているセッションユーザと同じでない場合はNULL。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_timed_checkpoints()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>（<TT
CLASS="VARNAME"
>checkpoint_timeout</TT
>時間経過したために）バックグランドライタが予定されたチェックポイントを起動した回数。
       </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_requested_checkpoints()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
><TT
CLASS="VARNAME"
>checkpoint_segments</TT
>を超えた、あるいは<TT
CLASS="COMMAND"
>CHECKPOINT</TT
>が呼び出されたという理由によりバックエンドからの要求に基づき、バックグランドライタがチェックポイントを起動した回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_buf_written_checkpoints()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>バックグランドライタがチェックポイント期間中に書き込んだバッファ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_buf_written_clean()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>ダーティページの書き出し処理のためにバックグランドライタが書き出したバッファ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_maxwritten_clean()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>バッファへの書き出しが<TT
CLASS="VARNAME"
>bgwriter_lru_maxpages</TT
>パラメータで指定した数以上発生したためにバックグランドライタが書き出し用スキャンを中断した回数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_bgwriter_stat_reset_time()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>timestamptz</TT
></TD
><TD
>      
        バックグラウンドライタの最後の統計情報リセット時間。データベースクラスタの上で<CODE
CLASS="FUNCTION"
>pg_stat_reset_shared('bgwriter')</CODE
>が実施された際に更新されます。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_buf_written_backend()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>新しいバッファ割り当てを行う必要があったためにバックエンドにより書き込まれたバッファ数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_get_buf_alloc()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD
>割り当てられたバッファの総数。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_clear_snapshot()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>void</TT
></TD
><TD
>現在の統計情報スナップショットを破棄します。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_reset()</CODE
></TT
></TD
><TD
><TT
CLASS="TYPE"
>void</TT
></TD
><TD
>現在のデータベースに関する統計カウンタすべてをゼロにリセットします（スーパーユーザ権限が必要です）。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_reset_shared</CODE
>(text)</TT
></TD
><TD
><TT
CLASS="TYPE"
>void</TT
></TD
><TD
>データベースクラスタの共有統計情報カウンタの一部をゼロに戻します（スーパーユーザ権限が必要です）。<TT
CLASS="LITERAL"
>pg_stat_reset_shared('bgwriter')</TT
>を呼び出すと、<TT
CLASS="STRUCTNAME"
>pg_stat_bgwriter</TT
>で示される値すべてがゼロになります。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_reset_single_table_counters</CODE
>(oid)</TT
></TD
><TD
><TT
CLASS="TYPE"
>void</TT
></TD
><TD
>現在のデータベース内にある、ひとつのテーブルあるいはインデックスの統計情報をゼロにリセットします（スーパーユーザ権限が必要です）。
      </TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
><CODE
CLASS="FUNCTION"
>pg_stat_reset_single_function_counters</CODE
>(oid)</TT
></TD
><TD
><TT
CLASS="TYPE"
>void</TT
></TD
><TD
>現在のデータベース内にある、ひとつの関数の統計情報をゼロにリセットします（スーパーユーザ権限が必要です）。
      </TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>&#27880;&#24847;: </B
><CODE
CLASS="FUNCTION"
>pg_stat_get_blocks_fetched</CODE
>から<CODE
CLASS="FUNCTION"
>pg_stat_get_blocks_hit</CODE
>を引くと、そのテーブル、インデックス、データベースに対して発行されたカーネルの<CODE
CLASS="FUNCTION"
>read()</CODE
>コール数がわかります。実際の物理的な読み取り数は、カーネルレベルのバッファ処理のために通常これより小さくなります。<TT
CLASS="LITERAL"
>*_blks_read</TT
>の統計情報カラムはfetched数からhit数を差し引いた結果を用いています。
    </P
></BLOCKQUOTE
></DIV
><P
>バックエンドに関する情報にアクセスする関数は、全てバックエンドのIDでインデックス化されています。ただし、<CODE
CLASS="FUNCTION"
>pg_stat_get_activity</CODE
>だけはPIDでインデックス化されています。<CODE
CLASS="FUNCTION"
>pg_stat_get_backend_idset</CODE
>関数は、活動中のサーバプロセスそれぞれについて1行を作成する簡便な方法を提供します。例えば、全てのサーバプロセスの<ACRONYM
CLASS="ACRONYM"
>PID</ACRONYM
>と現在の問い合わせを表示するには、以下を行います。

</P><PRE
CLASS="PROGRAMLISTING"
>SELECT pg_stat_get_backend_pid(s.backendid) AS procpid,
       pg_stat_get_backend_activity(s.backendid) AS current_query
    FROM (SELECT pg_stat_get_backend_idset() AS backendid) AS s;</PRE
><P>
  </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="monitoring-ps.html"
ACCESSKEY="P"
>&#21069;&#12398;&#12506;&#12540;&#12472;</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>&#12507;&#12540;&#12512;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="monitoring-locks.html"
ACCESSKEY="N"
>&#27425;&#12398;&#12506;&#12540;&#12472;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>標準的なUnixツール</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="monitoring.html"
ACCESSKEY="U"
>&#19978;&#12395;&#25147;&#12427;</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>ロックの表示</TD
></TR
></TABLE
></DIV
></BODY
></HTML
></div>
